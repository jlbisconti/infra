 Bloqueo de User-Agent de bots comunes
drop http any any -> $HOME_NET any (msg:"[DROP] Bot común detectado - User-Agent sospechoso"; flow:to_server,established; http.user_agent; content:"python"; nocase; sid:8000001; >drop http any any -> $HOME_NET any (msg:"[DROP] Bot común detectado - User-Agent sospechoso"; flow:to_server,established; http.user_agent; content:"curl"; nocase; sid:8000002; re>drop http any any -> $HOME_NET any (msg:"[DROP] Bot común detectado - User-Agent sospechoso"; flow:to_server,established; http.user_agent; content:"wget"; nocase; sid:8000003; re>
# Bloqueo de DNS hacia dominios maliciosos comunes
drop udp any any -> any 53 (msg:"[DROP] DNS request hacia dominio malicioso - duckdns.org"; dns.query; content:"duckdns.org"; endswith; nocase; sid:8000100; rev:1;)
drop udp any any -> any 53 (msg:"[DROP] DNS request hacia dominio malicioso - no-ip.com"; dns.query; content:"no-ip.com"; endswith; nocase; sid:8000101; rev:1;)
drop udp any any -> any 53 (msg:"[DROP] DNS request hacia dominio malicioso - dyndns.org"; dns.query; content:"dyndns.org"; endswith; nocase; sid:8000102; rev:1;)

# Bloqueo de URLs de phishing (patrones comunes)
drop http any any -> $HOME_NET any (msg:"[DROP] Posible phishing - URL sospechosa con 'login.php'"; flow:to_server,established; http.uri; content:"login.php"; nocase; sid:8000200>drop http any any -> $HOME_NET any (msg:"[DROP] Posible phishing - URL con webmail"; flow:to_server,established; http.host; content:"webmail."; sid:8000201; rev:2;)
# Bloqueo de tráfico HTTP con patrones de RATs o troyanos
drop http any any -> $HOME_NET any (msg:"[DROP] Posible acceso remoto tipo RAT - patrón típico"; flow:to_server,established; http.uri; content:"/gate.php"; nocase; sid:8000300; r>drop http any any -> $HOME_NET any (msg:"[DROP] Posible malware - descarga sospechosa .exe"; flow:to_server,established; http.uri; content:".exe"; nocase; sid:8000301; rev:2;)
# Misc Peligrosos
drop http any any -> $HOME_NET any (msg:"[DROP] Bot HTTP User-Agent sospechoso - curl"; flow:to_server,established; http.user_agent; content:"curl"; nocase; classtype:attempted-r>drop http any any -> $HOME_NET any (msg:"[DROP] Descarga de posible ejecutable malicioso .exe"; flow:to_server,established; http.uri; content:".exe"; nocase; classtype:trojan-act>drop dns any any -> any any (msg:"[DROP] DNS sospechoso - arenabg tracker detectado"; dns.query; content:"arenabg.com"; nocase; classtype:trojan-activity; sid:9000013; rev:1;)
drop dns any any -> any any (msg:"[DROP] DNS sospechoso - duckdns tracker detectado"; dns.query; content:"duckdns.org"; nocase; sid:9000014; rev:1;)
drop dns any any -> any any (msg:"[DROP] DNS sospechoso - dyndns detectado"; dns.query; content:"dyndns.org"; nocase; sid:9000015; rev:1;)
drop dns any any -> any any (msg:"[DROP] DNS sospechoso - no-ip detectado"; dns.query; content:"no-ip.com"; nocase; sid:9000016; rev:1;)
drop dns any any -> any any (msg:"[DROP] DNS sospechoso - malware domain detectado"; dns.query; content:"suspiciousdomain.xyz"; nocase; sid:9000017; rev:1;)

drop http any any -> $HOME_NET any (msg:"[DROP] HTTP con User-Agent sospechoso - botnet"; flow:to_server,established; http.user_agent; content:"masscan"; nocase; sid:9000018; rev:1;)
drop http any any -> $HOME_NET any (msg:"[DROP] HTTP posible C2/RAT por URI"; flow:to_server,established; http.uri; content:"/gate.php"; nocase; sid:9000019; rev:1;)
drop http any any -> $HOME_NET any (msg:"[DROP] HTTP posible phishing - contiene 'login.php' sospechoso"; flow:to_server,established; http.uri; content:"login.php"; nocase; sid:9000020; rev:1;)
drop http any any -> $HOME_NET any (msg:"[DROP] HTTP User-Agent curl sospechoso"; flow:to_server,established; http.user_agent; content:"curl"; nocase; sid:9000021; rev:1;)
